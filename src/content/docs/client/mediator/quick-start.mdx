---
title: Quick Start
---

Install [Shiny.Mediator](https://www.nuget.org/packages/Shiny.Mediator) from NuGet

First, let's create our request & event handlers

```csharp
using Shiny.Mediator;

public record TestRequest(string AnyArgs, int YouWant) : IRequest;
public record TestEvent(MyObject AnyArgs) : IEvent;

// and for request/response requests - we'll come back to this
public record TestResponseRequest : IRequest<TestResponse> {}
public record TestResponse {}
```

Next - let's wire up a RequestHandler.  You can have ONLY 1 request handler per request type.
This is where you would do the main business logic or data requests.

Let's create our RequestHandler

```csharp
using Shiny.Mediator;

// NOTE: Request handlers are registered as singletons
public class TestRequestHandler : IRequestHandler<TestRequest> 
{
    // you can do all dependency injection here
    public async Task Handle(TestRequest request, CancellationToken ct) 
    {
        // do something async here
    }
}

public class TestResponseRequestHandler : IRequestHandler<TestResponseRequest, TestResponse>
{
    public async Task<TestResponse> Handle(TestResponseRequest request, CancellationToken ct)
    {
        var response = await GetResponseThing(ct);
        return response;
    }
}

public class TestEventHandler : IEventHandler<TestEvent> 
{
    // Dependency injection works here
    public async Task Handle(TestEvent @event, CancellationToken ct)
    {
        // Do something async here
    }
}
```

Now, let's register all of our stuff with our .NET MAUI MauiProgram.cs

```csharp
public static class MauiProgram
{
    public static MauiApp CreateMauiApp()
    {
        var builder = MauiApp
            .CreateBuilder()
            .UseMauiApp<App>();
        
        builder.Services.AddShinyMediator();
        builder.Services.AddSingletonAsImplementedInterfaces<TestEventHandler>();
        builder.Services.AddSingletonAsImplementedInterfaces<TestRequestHandler>();
        builder.Services.AddSingltonAsImplementedInterfaces<TestResponseRequestHandler>();
        // OR if you're using our attribute for source generation
    }
}
```

Lastly, any model model/viewmodel/etc participating in dependency injection can now inject the mediator

```csharp
public class MyViewModel(Shiny.Mediator.IMediator mediator)
{
    public async Task Execute() 
    {
        await mediator.Send(new TestRequest()); // this will execute TestRequestHandler
        var response = await mediator.Request(new TestResponseRequest()); // this will execute TestResponseRequestHandler and return a value
        
        // this will publish to any service registered that implement IEventHandler<TestEvent>
        // there are additional args here to allow you to execute values in sequentially or wait for all events to complete
        await mediator.Publish(new TestEvent()); 
    }
}
```

### What about my ViewModels?

For .NET MAUI, your viewmodels have the ability to participate in the event publishing chain without being part of dependency injection

With this setup, you don't need to worry about deallocating any events, unsubscribing from some service, or hooking to anything.

Lastly, if your page/viewmodel is navigated away from (popped), it will no longer participate in the event broadcast

First, let's install [Shiny.Mediator.Maui](https://www.nuget.org/packages/Shiny.Mediator.Maui)
Now...let's go back to our MauiProgram.cs and alter the AddShinyMediator

```csharp
builder.Services.AddShinyMediator(cfg => cfg.UseMaui());
```

Now your viewmodel (or page) can simply implement the IEventHandler interface to participate

:::note
Further example to below - you can implement multiple event handlers (or request handlers)
:::

```csharp
public class MyViewModel : BaseViewModel, 
                           Shiny.Mediator.IEventHandler<TestEvent>,
                           Shiny.Mediator.IEventHandler<TestEvent>
{
    public async Task Handle(TestEvent @event, CancellationToken ct)
    {
    }
    
    public async Task Handle(TestEvent2 @event, CancellationToken ct)
    {
    }
}
```